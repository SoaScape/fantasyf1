<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="header :: head" />
<body ng-app="ff1App" ng-controller="controller">		
	<div th:replace="header :: header"/>	
	
	<div class="panel panel-primary" ng-init="getStandinDrivers();getMainDrivers();getCars();getRaceCalendar();">
	<div class="panel-heading text-center">Stand In Drivers</div>	
	<div class="panel-body">
		<div class="panel panel-info">
		<div class="panel-heading text-center">Drivers</div>	
		<div class="panel-body">
		<table class="table table-striped">
			<tbody>
				<tr>
					<th>Name</th>
					<th>Number</th>
					<th>Car</th>
					<th>Rounds</th>
					<th>Action</th>
				</tr>
				<tr ng-repeat="driver in standinDrivers">
					<td><input type="text" class="form-control" ng-model="driver.name"/></td>
					<td><input type="number" class="form-control" ng-model="driver.number"/></td>
					<td>
						<div class="dropdown">
						  <button class="btn btn-default dropdown-toggle" type="button" id="carDropdown" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
						    {{driver.car.name}}
						    <span class="caret"></span>
						  </button>
						  <ul class="dropdown-menu" aria-labelledby="carDropdown">
						  <table class="table table-striped table-responsive">
						    <thead>
						      <tr>
						        <th>Car</th>
						      </tr>
						    </thead>
						    <tbody>
						      <tr ng-repeat="car in cars | orderBy:'name'">
						        <td>					        	
						        	<a href="#" class="a-unstyled" ng-click="driver.car = car;">{{car.name}}</a>
						        	<span ng-if="driver.car.name==car.name">&nbsp;<span class="glyphicon glyphicon-hand-left"></span></span>					        	
						        </td>
						      </tr>
						    </tbody>
						    </table>
						  </ul>
						</div>
					</td>
					<td>
						<div class="dropdown">
				            <a id="dLabel" role="button" data-toggle="dropdown" class="btn btn-primary" data-target="#">
				                Standin Rounds <span class="caret"></span>
				            </a>
				    		<ul class="dropdown-menu multi-level" role="menu" aria-labelledby="dropdownMenu">
				              <li><a href="#">Add</a></li>
				              <li class="divider"></li>
				              <li ng-repeat="(round, mainDriverz) in driver.standinRoundsDrivers"><a href="#" data-toggle="modal" data-target="standinRoundsModal">{{mainDriverz}} at {{round}}</a></li>
				            </ul>
				        </div>
					</td>
					<td><button type="button" class="btn btn-danger" ng-click="deleteDriver($index);">Delete</button></td>
				</tr>				
			</tbody>			
		</table>
		<button type="button" class="btn btn-danger" ng-click="addStandinDriver();">Add</button>
		<button type="button" class="btn btn-success" ng-click="saveDrivers();">Save</button>
		<div id="driversSpinner" style="display: none;" class="spinner-loader pull-right">Updating...</div>
	    {{driversStatus}}
		</div>
		</div>
	</div>
	</div>
	
	<!-- Standin Rounds Modal -->
  <div class="modal fade" id="standinRoundsModal" role="dialog">
	<div class="modal-dialog">
		<!-- Modal content-->
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal">&times;</button>				
				<div class="panel panel-info">
					<div class="panel-heading text-center">Standing in for {{mainDriverz}} at {{round}}</div>	
					<div class="panel-body">
	                    <ul class="dropdown-menu">
	                        <li ng-repeat="(raceround, race) in raceCalendar"><a href="#" ng-click="round = raceround">{{race.grandPrixName}}</a></li>
	                        <li ng-repeat="mainDriver in drivers"><a href="#" ng-click="driver = driver.number">{{driver.name}}</a></li>
	                    </ul>
					</div>
				</div>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-default btn-primary btn-sm"
					data-dismiss="modal">Close</button>
			</div>
		</div>
	</div>
  </div>
  
  <div th:replace="footer :: footer" />
</body>
</html>
